#!/bin/bash

# change tables type
sed -i 's/MyISAM/InnoDB/g' $1

# forbid AUTOCOMMIT etc.
sed -i '1i\
@OLD_AUTOCOMMIT=@@AUTOCOMMIT, AUTOCOMMIT = 0;\
@OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS = 0;\
@OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS = 0;\
\n' $1 

# return settings
sed -i '$a\
@OLD_AUTOCOMMIT=@@AUTOCOMMIT, AUTOCOMMIT = 0;\
@OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS = 0;\
@OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS = 0;\
\n' $1 


